tut7.py,
---------------
from flask import Flask, redirect, url_for, render_template, request, session, flash
from datetime import timedelta
from flask_sqlalchemy import SQLAlchemy
import pymysql

app=Flask(__name__)
app.secret_key = "hello"
app.config['SQLALCHEMY_DATABASE_URI']="mysql+pymysql://root:system@localhost/users"
app.permanent_session_lifetime = timedelta(minutes=5)
db=SQLAlchemy(app)

class users(db.Model):
    id=db.Column('id', db.Integer, primary_key = True)
    name=db.Column('name',db.String(100))
    email=db.Column('email',db.String(100))

    def __init__(self,name,email):
        self.name=name
        self.email=email

@app.route("/login", methods=["POST", "GET"])
def login():
    if request.method == "POST":
        session.permanent = True  # <--- makes the permanent session
        user = request.form["nm"]
        session["user"] = user
        found_user=users.query.filter_by(name=user).first()

        if found_user:
            session['email']=found_user.email
        else:
            usr=users(user,"")
            db.session.add(usr)
            db.session.commit()

        flash("Congratulations Logging","info")
        return redirect(url_for("user"))
    else:
        if "user" in session:
            flash("You are already logged in","info")
            return redirect(url_for("user"))

        return render_template("login.html")

@app.route("/user", methods=["POST", "GET"])
def user():
    email=None
    if "user" in session:
        user = session["user"]
        if request.method == "POST":
            email=request.form['email']
            session['email']=email
            found_user=users.query.filter_by(name=user).first()
            found_user.email=email
            db.session.commit()
            flash("Email was saved","info")
        else:
            if 'email' in session:
                email=session['email']
        return render_template("user.html",email=email)
    else:
        flash("Please Login First","info")
        return redirect(url_for("login"))

@app.route("/view")
def views():
    return render_template("view.html",values=users.query.all())

@app.route("/logout")
def logout():
    flash("You have been logged out Successfully","info")
    session.pop("user", None)
    session.pop("email",None)
    return redirect(url_for("login"))

if __name__ == '__main__':
           db.create_all()
           app.run(debug=True)  

In Templates folder,
user.html,
-------------
{% extends "base.html" %}
{% block title %}User Page{% endblock %}

{% block content %}
    {% with messages=get_flashed_messages() %}
         {% if messages %}
              {% for msg in messages %}
                  <p>{{msg}}</p>
              {% endfor %}
         {% endif %}
    {% endwith %}

   <h1>Hello {{user}}</h1>
   <form action="#" method="post">
   	<input type="email" name="email" placeholder="Enter your email">
   	<input type="submit" value="submit">
   </form>

{% endblock %}    

view.html,
----------------
{% extends "base.html" %}
{% block title %}View Page{% endblock %}

{% block content %}
  {% for item in values%}
     <p>Name:- {{item.name}}</p>
     <p>Email:- {{item.email}}</p>
  {% endfor %}
{% endblock %}                   